const axios = require('axios');
const { Pool } = require('pg');

// Remplacez par votre clé API
const API_KEY = 'XxXxXxXxXxXxXxXxXxXxXxXx';
const API_URL = 'https://v3.football.api-sports.io/standings';

// Configuration de la connexion à la base de données
const pool = new Pool({
  user: 'postgres',
  host: 'localhost',
  database: 'osm_data',
  password: 'nouveau_mot_de_passe',
  port: 5432,
});

async function fetchSportsEvents() {
  try {
    const response = await axios.get(API_URL, {
      params: {
        league: 39,
        season: 2019,
      },
      headers: {
        'x-rapidapi-host': 'v3.football.api-sports.io',
        'x-rapidapi-key': API_KEY,
      },
    });

    const events = response.data.response;

    for (const event of events) {
      const { id, name, city, country_name } = event;
      const query = 'INSERT INTO sports_events (id, name, city, country) VALUES ($1, $2, $3, $4) ON CONFLICT (id) DO NOTHING';
      const values = [id, name, city, country_name];

      await pool.query(query, values);
    }

    console.log('Sports events imported successfully');
  } catch (error) {
    console.error('Error fetching sports events:', error);
  }
}

fetchSportsEvents();
